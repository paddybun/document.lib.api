@page "/Description/{group}"
@using document.lib.data.models.RegisterDescriptions
@using Microsoft.EntityFrameworkCore

@rendermode InteractiveServer

@inject IDbContextFactory<DatabaseContext> DbContextFactory
@inject NotificationService NotificationService
@inject IStringLocalizer<Resources> L
@inject IJSRuntime JSRuntime

@inject IRegisterDescriptionQuery<UnitOfWork> RegisterDescriptionQuery

@if (_model != null)
{
    <RadzenRow>
        <RadzenColumn Size="6">
            <RadzenFieldset>
                <RadzenStack Orientation="Orientation.Vertical">
                    <RadzenFormField AllowFloatingLabel="false" Text=@L["Descriptions.Group"]>
                        <RadzenTextBox @bind-Value="_model.Group"/>
                    </RadzenFormField>
                </RadzenStack>
            </RadzenFieldset>
            <RadzenDataGrid @ref="_grid" Data="@_gridModel" AllowSorting="true" SelectionMode="DataGridSelectionMode.Single" @bind-Value="_selectedDescriptions" RowRender="@RowRender" EditMode="@_editMode">
                <Columns>
                    <RadzenDataGridColumn Property="@nameof(RegisterDescriptionEntryModel.Id)"/>
                    <RadzenDataGridColumn Property="@nameof(RegisterDescriptionEntryModel.DisplayName)">
                        <EditTemplate Context="description">
                            <RadzenTextBox @bind-Value="description.DisplayName" />
                        </EditTemplate>
                    </RadzenDataGridColumn>
                    <RadzenDataGridColumn Context="order" Filterable="false" Sortable="false" TextAlign="TextAlign.Right" Frozen="true" FrozenPosition="FrozenColumnPosition.Right">
                        <Template Context="order">
                            <RadzenButton Icon="edit" ButtonStyle="ButtonStyle.Light" Variant="Variant.Flat" Size="ButtonSize.Medium" class="rz-my-1 rz-ms-1" Click="@(args => EditRow(order))" @onclick:stopPropagation="true" />
                        </Template>
                    </RadzenDataGridColumn>
                </Columns>
            </RadzenDataGrid>
        </RadzenColumn>
    </RadzenRow>
}